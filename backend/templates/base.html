<!doctype html>
<title>{% block title %}{% endblock %}</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kanit&family=Montserrat&family=Open+Sans:wght@500&display=swap"
    rel="stylesheet">

<body>
    <div class="full-body-container">
        <div class="top-text">
            <h1 class="title">AniMate</h1>
            <p class="search-description">Discover anime recommendations based on your favorite shows</p>
            <div class="search-container">
                <div class="input-box" onclick="sendFocus()">
                    <img src="{{ url_for('static', filename='images/mag.png') }}" />
                    <input placeholder="Enter an anime title and get recommendations based on the title"
                        id="filter-text-val" onkeyup="filterText()" autocomplete="off">
                </div>
                <div id="suggestions-box" class="suggestions-box"></div>
                <button id="search-button" class="search-button" onclick="searchAnime()">Search</button>
            </div>
        </div>
        <div class="or-divider">
            <span class="or-text">OR</span>
        </div>
        <div class="filter-container">
            <div class="filter-text">
                I am looking for an animes with
                <div class="filter-dropdown">
                    <button class="filter-button" onclick="toggleDropdown('genres')">Select Genres</button>
                    <div id="genres-dropdown" class="dropdown-content">
                        <label><input type="checkbox" value="Action"> Action</label>
                        <label><input type="checkbox" value="Adventure"> Adventure</label>
                        <label><input type="checkbox" value="Avant Garde"> Avant Garde</label>
                        <label><input type="checkbox" value="Award Winning"> Award Winning</label>
                        <label><input type="checkbox" value="Boys Love"> Boys Love</label>
                        <label><input type="checkbox" value="Comedy"> Comedy</label>
                        <label><input type="checkbox" value="Drama"> Drama</label>
                        <label><input type="checkbox" value="Ecchi"> Ecchi</label>
                        <label><input type="checkbox" value="Erotica"> Erotica</label>
                        <label><input type="checkbox" value="Fantasy"> Fantasy</label>
                        <label><input type="checkbox" value="Girls Love"> Girls Love</label>
                        <label><input type="checkbox" value="Gourmet"> Gourmet</label>
                        <label><input type="checkbox" value="Horror"> Horror</label>
                        <label><input type="checkbox" value="Mystery"> Mystery</label>
                        <label><input type="checkbox" value="Romance"> Romance</label>
                        <label><input type="checkbox" value="Sci-Fi"> Sci-Fi</label>
                        <label><input type="checkbox" value="Slice of Life"> Slice of Life</label>
                        <label><input type="checkbox" value="Sports"> Sports</label>
                        <label><input type="checkbox" value="Supernatural"> Supernatural</label>
                        <label><input type="checkbox" value="Suspense"> Suspense</label>
                    </div>
                </div>
                containing
                <div class="filter-dropdown">
                    <button class="filter-button" onclick="toggleDropdown('episodes')">Select Episode Range</button>
                    <div id="episodes-dropdown" class="dropdown-content">
                        <label><input type="checkbox" value="1-10"> 1-10</label>
                        <label><input type="checkbox" value="11-20"> 11-20</label>
                        <label><input type="checkbox" value="21-30"> 21-30</label>
                        <label><input type="checkbox" value="31-60"> 31-60</label>
                        <label><input type="checkbox" value="61-100"> 61-100</label>
                        <label><input type="checkbox" value="101-200"> 101-200</label>
                        <label><input type="checkbox" value="201-1000"> 201-1000</label>
                        <label><input type="checkbox" value="1001-4000"> 1001-4000</label>
                    </div>
                </div>
                episodes, that is from any of
                <div class="filter-dropdown">
                    <button class="filter-button" onclick="toggleDropdown('studios')">Select Studios</button>
                    <div id="studios-dropdown" class="dropdown-content">
                        <label><input type="checkbox" value="Toei Animation"> Toei Animation</label>
                        <label><input type="checkbox" value="Sunrise"> Sunrise</label>
                        <label><input type="checkbox" value="Madhouse"> Madhouse</label>
                        <label><input type="checkbox" value="J.C.Staff"> J.C.Staff</label>
                        <label><input type="checkbox" value="Studio Deen"> Studio Deen</label>
                        <label><input type="checkbox" value="Nippon Animation"> Nippon Animation</label>
                        <label><input type="checkbox" value="TMS Entertainment"> TMS Entertainment</label>
                        <label><input type="checkbox" value="Pierrot"> Pierrot</label>
                        <label><input type="checkbox" value="Tatsunoko Production"> Tatsunoko Production</label>
                        <label><input type="checkbox" value="OLM"> OLM</label>
                        <label><input type="checkbox" value="A-1 Pictures"> A-1 Pictures</label>
                        <label><input type="checkbox" value="Gonzo"> Gonzo</label>
                        <label><input type="checkbox" value="SILVER LINK."> SILVER LINK.</label>
                        <label><input type="checkbox" value="Xebec"> Xebec</label>
                        <label><input type="checkbox" value="Production I.G"> Production I.G</label>
                        <label><input type="checkbox" value="DLE"> DLE</label>
                        <label><input type="checkbox" value="Satelight"> Satelight</label>
                        <label><input type="checkbox" value="Doga Kobo"> Doga Kobo</label>
                        <label><input type="checkbox" value="Bones"> Bones</label>
                        <label><input type="checkbox" value="Shaft"> Shaft</label>
                        <label><input type="checkbox" value="Shin-Ei Animation"> Shin-Ei Animation</label>
                        <label><input type="checkbox" value="LIDENFILMS"> LIDENFILMS</label>
                        <label><input type="checkbox" value="Group TAC"> Group TAC</label>
                        <label><input type="checkbox" value="Brain's Base"> Brain's Base</label>
                        <label><input type="checkbox" value="feel."> feel.</label>
                        <label><input type="checkbox" value="MAPPA"> MAPPA</label>
                        <label><input type="checkbox" value="AIC"> AIC</label>
                        <label><input type="checkbox" value="Diomedéa"> Diomedéa</label>
                        <label><input type="checkbox" value="Gallop"> Gallop</label>
                        <label><input type="checkbox" value="Studio Comet"> Studio Comet</label>
                        <label><input type="checkbox" value="Zexcs"> Zexcs</label>
                        <label><input type="checkbox" value="Ashi Productions"> Ashi Productions</label>
                        <label><input type="checkbox" value="Tokyo Movie Shinsha"> Tokyo Movie Shinsha</label>
                        <label><input type="checkbox" value="P.A. Works"> P.A. Works</label>
                        <label><input type="checkbox" value="Eiken"> Eiken</label>
                        <label><input type="checkbox" value="Kachidoki Studio"> Kachidoki Studio</label>
                        <label><input type="checkbox" value="Kyoto Animation"> Kyoto Animation</label>
                        <label><input type="checkbox" value="Tezuka Productions"> Tezuka Productions</label>
                        <label><input type="checkbox" value="TNK"> TNK</label>
                        <label><input type="checkbox" value="Studio Hibari"> Studio Hibari</label>
                        <label><input type="checkbox" value="Studio Gokumi"> Studio Gokumi</label>
                        <label><input type="checkbox" value="Project No.9"> Project No.9</label>
                        <label><input type="checkbox" value="Gainax"> Gainax</label>
                        <label><input type="checkbox" value="Lerche"> Lerche</label>
                        <label><input type="checkbox" value="EMT Squared"> EMT Squared</label>
                        <label><input type="checkbox" value="CloverWorks"> CloverWorks</label>
                        <label><input type="checkbox" value="Bee Train"> Bee Train</label>
                        <label><input type="checkbox" value="Kinema Citrus"> Kinema Citrus</label>
                        <label><input type="checkbox" value="8bit"> 8bit</label>
                        <label><input type="checkbox" value="A.C.G.T."> A.C.G.T.</label>
                        <label><input type="checkbox" value="Nomad"> Nomad</label>
                        <label><input type="checkbox" value="Hal Film Maker"> Hal Film Maker</label>
                        <label><input type="checkbox" value="Telecom Animation Film"> Telecom Animation Film</label>
                        <label><input type="checkbox" value="Fanworks"> Fanworks</label>
                        <label><input type="checkbox" value="Arms"> Arms</label>
                        <label><input type="checkbox" value="Radix"> Radix</label>
                        <label><input type="checkbox" value="SynergySP"> SynergySP</label>
                        <label><input type="checkbox" value="Seven"> Seven</label>
                        <label><input type="checkbox" value="Artland"> Artland</label>
                        <label><input type="checkbox" value="White Fox"> White Fox</label>
                        <label><input type="checkbox" value="Zero-G"> Zero-G</label>
                        <label><input type="checkbox" value="Seven Arcs"> Seven Arcs</label>
                        <label><input type="checkbox" value="Magic Bus"> Magic Bus</label>
                        <label><input type="checkbox" value="Ajia-do"> Ajia-do</label>
                        <label><input type="checkbox" value="Asahi Production"> Asahi Production</label>
                        <label><input type="checkbox" value="C2C"> C2C</label>
                        <label><input type="checkbox" value="E&G Films"> E&G Films</label>
                        <label><input type="checkbox" value="Actas"> Actas</label>
                        <label><input type="checkbox" value="Shogakukan Music & Digital Entertainment"> Shogakukan Music
                            & Digital Entertainment</label>
                        <label><input type="checkbox" value="Knack Productions"> Knack Productions</label>
                        <label><input type="checkbox" value="David Production"> David Production</label>
                        <label><input type="checkbox" value="Wit Studio"> Wit Studio</label>
                        <label><input type="checkbox" value="Daume"> Daume</label>
                        <label><input type="checkbox" value="Manglobe"> Manglobe</label>
                        <label><input type="checkbox" value="Passione"> Passione</label>
                        <label><input type="checkbox" value="Bandai Namco Pictures"> Bandai Namco Pictures</label>
                        <label><input type="checkbox" value="Creators in Pack"> Creators in Pack</label>
                        <label><input type="checkbox" value="Trans Arts"> Trans Arts</label>
                        <label><input type="checkbox" value="Tokyo Kids"> Tokyo Kids</label>
                        <label><input type="checkbox" value="AIC Spirits"> AIC Spirits</label>
                        <label><input type="checkbox" value="Production Reed"> Production Reed</label>
                        <label><input type="checkbox" value="SANZIGEN"> SANZIGEN</label>
                        <label><input type="checkbox" value="asread."> asread.</label>
                        <label><input type="checkbox" value="ufotable"> ufotable</label>
                        <label><input type="checkbox" value="AIC ASTA"> AIC ASTA</label>
                        <label><input type="checkbox" value="Mushi Production"> Mushi Production</label>
                        <label><input type="checkbox" value="GoHands"> GoHands</label>
                        <label><input type="checkbox" value="Hoods Entertainment"> Hoods Entertainment</label>
                        <label><input type="checkbox" value="Bridge"> Bridge</label>
                        <label><input type="checkbox" value="Geek Toys"> Geek Toys</label>
                        <label><input type="checkbox" value="Connect"> Connect</label>
                        <label><input type="checkbox" value="Trigger"> Trigger</label>
                        <label><input type="checkbox" value="Production IMS"> Production IMS</label>
                        <label><input type="checkbox" value="Studio 3Hz"> Studio 3Hz</label>
                        <label><input type="checkbox" value="AXsiZ"> AXsiZ</label>
                        <label><input type="checkbox" value="Maho Film"> Maho Film</label>
                        <label><input type="checkbox" value="Yumeta Company"> Yumeta Company</label>
                        <label><input type="checkbox" value="Triangle Staff"> Triangle Staff</label>
                        <label><input type="checkbox" value="TYO Animations"> TYO Animations</label>
                        <label><input type="checkbox" value="Pierrot Plus"> Pierrot Plus</label>
                        <label><input type="checkbox" value="Gathering"> Gathering</label>
                        <label><input type="checkbox" value="ILCA"> ILCA</label>
                        <label><input type="checkbox" value="NAZ"> NAZ</label>
                        <label><input type="checkbox" value="TROYCA"> TROYCA</label>
                        <label><input type="checkbox" value="Studio A-CAT"> Studio A-CAT</label>
                        <label><input type="checkbox" value="ENGI"> ENGI</label>
                        <label><input type="checkbox" value="Picture Magic"> Picture Magic</label>
                        <label><input type="checkbox" value="Orange"> Orange</label>
                        <label><input type="checkbox" value="Lay-duce"> Lay-duce</label>
                        <label><input type="checkbox" value="Encourage Films"> Encourage Films</label>
                        <label><input type="checkbox" value="Signal.MD"> Signal.MD</label>
                        <label><input type="checkbox" value="Yokohama Animation Lab"> Yokohama Animation Lab</label>
                        <label><input type="checkbox" value="Studio Live"> Studio Live</label>
                        <label><input type="checkbox" value="Trinet Entertainment"> Trinet Entertainment</label>
                        <label><input type="checkbox" value="Telescreen"> Telescreen</label>
                        <label><input type="checkbox" value="Shirogumi"> Shirogumi</label>
                        <label><input type="checkbox" value="Daewon Media"> Daewon Media</label>
                        <label><input type="checkbox" value="Seven Arcs Pictures"> Seven Arcs Pictures</label>
                        <label><input type="checkbox" value="Platinum Vision"> Platinum Vision</label>
                        <label><input type="checkbox" value="PINE JAM"> PINE JAM</label>
                        <label><input type="checkbox" value="Blade"> Blade</label>
                        <label><input type="checkbox" value="Plum"> Plum</label>
                        <label><input type="checkbox" value="Vega Entertainment"> Vega Entertainment</label>
                        <label><input type="checkbox" value="Dongwoo A&E"> Dongwoo A&E</label>
                        <label><input type="checkbox" value="AIC PLUS+"> AIC PLUS+</label>
                        <label><input type="checkbox" value="Polygon Pictures"> Polygon Pictures</label>
                        <label><input type="checkbox" value="C-Station"> C-Station</label>
                        <label><input type="checkbox" value="Shuka"> Shuka</label>
                        <label><input type="checkbox" value="Graphinica"> Graphinica</label>
                        <label><input type="checkbox" value="Millepensee"> Millepensee</label>
                        <label><input type="checkbox" value="Nexus"> Nexus</label>
                        <label><input type="checkbox" value="Bibury Animation Studios"> Bibury Animation Studios</label>
                        <label><input type="checkbox" value="Studio Kai"> Studio Kai</label>
                        <label><input type="checkbox" value="Studio Fantasia"> Studio Fantasia</label>
                        <label><input type="checkbox" value="APPP"> APPP</label>
                        <label><input type="checkbox" value="DAX Production"> DAX Production</label>
                        <label><input type="checkbox" value="Jinnis Animation Studios"> Jinnis Animation Studios</label>
                        <label><input type="checkbox" value="OLM Digital"> OLM Digital</label>
                        <label><input type="checkbox" value="Studio Blanc."> Studio Blanc.</label>
                        <label><input type="checkbox" value="Assez Finaud Fabric"> Assez Finaud Fabric</label>
                        <label><input type="checkbox" value="Felix Film"> Felix Film</label>
                        <label><input type="checkbox" value="Ascension"> Ascension</label>
                        <label><input type="checkbox" value="Tomovies"> Tomovies</label>
                        <label><input type="checkbox" value="W-Toon Studio"> W-Toon Studio</label>
                        <label><input type="checkbox" value="DMM.futureworks"> DMM.futureworks</label>
                        <label><input type="checkbox" value="Lapin Track"> Lapin Track</label>
                        <label><input type="checkbox" value="Haoliners Animation League"> Haoliners Animation
                            League</label>
                        <label><input type="checkbox" value="Puzzle Animation Studio Limited"> Puzzle Animation Studio
                            Limited</label>
                        <label><input type="checkbox" value="Typhoon Graphics"> Typhoon Graphics</label>
                        <label><input type="checkbox" value="SAMG Entertainment"> SAMG Entertainment</label>
                    </div>
                </div>
                and has a viewing rating of
                <div class="filter-dropdown">
                    <button class="filter-button" onclick="toggleDropdown('ratings')">Select Rating</button>
                    <div id="ratings-dropdown" class="dropdown-content">
                        <label><input type="checkbox" value="G - All Ages"> G - All Ages</label>
                        <label><input type="checkbox" value="PG - Children"> PG - Children</label>
                        <label><input type="checkbox" value="PG-13 - Teens 13 or older"> PG-13 - Teens 13 or
                            older</label>
                        <label><input type="checkbox" value="R - 17+ (violence & profanity)"> R - 17+ (violence &
                            profanity)</label>
                        <label><input type="checkbox" value="R+ - Mild Nudity"> R+ - Mild Nudity</label>
                        <label><input type="checkbox" value="UNKNOWN"> UNKNOWN</label>
                    </div>
                </div>
            </div>
            <div class="description-container">
                <input type="text" id="description-input"
                    placeholder="Description of the type of animes you want. Please be as descriptive as possible">
                <button class="search-button" onclick="searchWithFilters()">Search with Filters</button>
            </div>
        </div>
        <div id="answer-box">
        </div>
    </div>

    <style>
        .or-divider {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            position: relative;
        }

        .or-divider::before,
        .or-divider::after {
            content: "";
            flex: 1;
            border-bottom: 1px solid #ccc;
        }

        .or-text {
            padding: 0 10px;
            color: #666;
            font-size: 16px;
            background: white;
        }

        .filter-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .filter-text {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 16px;
            line-height: 1.5;
        }

        .filter-dropdown {
            position: relative;
            display: inline-block;
        }

        .filter-button {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            min-width: 150px;
            text-align: left;
        }

        .filter-button:hover {
            background-color: #e9ecef;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 200px;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1;
            border-radius: 4px;
            padding: 10px;
        }

        .dropdown-content label {
            display: block;
            padding: 5px 0;
            cursor: pointer;
        }

        .dropdown-content label:hover {
            background-color: #f8f9fa;
        }

        .description-container {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        #description-input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        #description-input:focus {
            outline: none;
            border-color: #007bff;
        }
    </style>

    <script>
        let selectedAnime = null;

        function answerBoxTemplate(anime) {
            const imageUrl = anime['Image URL'] || 'https://via.placeholder.com/200x300?text=No+Image';
            const cleanSynopsis = (anime.Synopsis || '').replace(/\\n/g, ' ').replace(/\\/g, '');

            return `
                <div class='recommendation-card'>
                    <div class='anime-image'>
                        <img src="${imageUrl}" alt="${anime.Name}" onerror="this.src='https://via.placeholder.com/200x300?text=No+Image'">
                    </div>
                    <div class='anime-info'>
                        <h3 class='anime-title'>${anime.Name}</h3>
                        <p class='anime-rating'>Rating: ${anime.Score || 'N/A'}</p>
                        <p class='anime-genres'>Genres: ${anime.Genres || 'N/A'}</p>
                        <p class='anime-episodes'>Episodes: ${anime.Episodes || 'N/A'}</p>
                        <p class='anime-studios'>Studios: ${anime.Studios || 'N/A'}</p>
                        <p class='anime-age-rating'>Age Rating: ${anime.Rating || 'N/A'}</p>
                        <p class='anime-synopsis'>${cleanSynopsis || 'No synopsis available'}</p>
                        <p class='similarity-score'>Similarity Score: ${anime.similarity ? anime.similarity.toFixed(3) : 'N/A'}</p>
                        
                    </div>
                </div>`
        }

        function sendFocus() {
            document.getElementById("filter-text-val").focus()
        }

        function filterText() {
            const searchValue = document.getElementById("filter-text-val").value
            if (searchValue.length < 2) {
                document.getElementById("suggestions-box").innerHTML = ""
                return
            }

            fetch("/suggestions?" + new URLSearchParams({ query: searchValue }).toString())
                .then((response) => response.json())
                .then((data) => {
                    const suggestionsBox = document.getElementById("suggestions-box")
                    suggestionsBox.innerHTML = ""
                    data.forEach(name => {
                        let div = document.createElement("div")
                        div.className = "suggestion-item"
                        div.innerHTML = name
                        div.onclick = () => selectAnime(name)
                        suggestionsBox.appendChild(div)
                    })
                })
        }

        function selectAnime(name) {
            selectedAnime = name;
            document.getElementById("filter-text-val").value = name;
            document.getElementById("suggestions-box").innerHTML = "";
        }

        function searchAnime() {
            if (!selectedAnime) {
                alert("Please select an anime from the suggestions");
                return;
            }

            document.getElementById("answer-box").innerHTML = ""
            fetch("/recommendations?" + new URLSearchParams({ title: selectedAnime }).toString())
                .then((response) => response.json())
                .then((data) => {
                    if (data.length === 0) {
                        document.getElementById("answer-box").innerHTML =
                            "<p class='no-results'>No recommendations found. Try a different anime title.</p>"
                        return
                    }
                    console.log("datad", data)
                    data.forEach(anime => {
                        let tempDiv = document.createElement("div")
                        tempDiv.innerHTML = answerBoxTemplate(anime)
                        document.getElementById("answer-box").appendChild(tempDiv)
                    })
                })
                .catch(error => {
                    console.error('Error:', error)
                    document.getElementById("answer-box").innerHTML =
                        "<p class='error-message'>An error occurred. Please try again.</p>"
                });
        }

        function toggleDropdown(dropdownId) {
            const dropdown = document.getElementById(`${dropdownId}-dropdown`);
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        function updateButtonText(dropdownId) {
            const selectedItems = Array.from(document.querySelectorAll(`#${dropdownId}-dropdown input:checked`))
                .map(cb => cb.parentElement.textContent.trim());
            const button = document.querySelector(`button[onclick="toggleDropdown('${dropdownId}')"]`);

            if (selectedItems.length > 0) {
                button.textContent = selectedItems.join(', ');
            } else {
                button.textContent = `Select ${dropdownId.charAt(0).toUpperCase() + dropdownId.slice(1)}`;
            }
        }

        function searchWithFilters() {
            const selectedGenres = Array.from(document.querySelectorAll('#genres-dropdown input:checked')).map(cb => cb.value);
            const selectedEpisodes = Array.from(document.querySelectorAll('#episodes-dropdown input:checked')).map(cb => cb.value);
            const selectedStudios = Array.from(document.querySelectorAll('#studios-dropdown input:checked')).map(cb => cb.value);
            const selectedRatings = Array.from(document.querySelectorAll('#ratings-dropdown input:checked')).map(cb => cb.value);
            const description = document.getElementById('description-input').value;

            // Clear previous results
            document.getElementById("answer-box").innerHTML = "";

            // Make API call with filters
            fetch("/filtered_recommendations", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    genres: selectedGenres,
                    episodes: selectedEpisodes,
                    studios: selectedStudios,
                    ratings: selectedRatings,
                    description: description
                })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.length === 0) {
                        document.getElementById("answer-box").innerHTML =
                            "<p class='no-results'>No recommendations found. Try adjusting your filters or description.</p>";
                        return;
                    }

                    data.forEach(anime => {
                        let tempDiv = document.createElement("div");
                        tempDiv.innerHTML = answerBoxTemplate(anime);
                        document.getElementById("answer-box").appendChild(tempDiv);
                    });
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById("answer-box").innerHTML =
                        "<p class='error-message'>An error occurred. Please try again.</p>";
                });
        }

        // Close suggestions when clicking outside
        document.addEventListener('click', function (event) {
            const suggestionsBox = document.getElementById("suggestions-box")
            const inputBox = document.querySelector(".input-box")
            if (!inputBox.contains(event.target) && !suggestionsBox.contains(event.target)) {
                suggestionsBox.innerHTML = ""
            }
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', function (event) {
            if (!event.target.matches('.filter-button') && !event.target.matches('.dropdown-content *')) {
                document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            }
        });

        // Add event listeners for checkbox changes
        document.querySelectorAll('.dropdown-content input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', function () {
                const dropdownId = this.closest('.dropdown-content').id.replace('-dropdown', '');
                updateButtonText(dropdownId);
            });
        });
    </script>
</body>

</html>